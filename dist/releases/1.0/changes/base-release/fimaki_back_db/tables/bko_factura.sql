-- liquibase formatted sql
-- changeset FIMAKI_BACK_DB:1755640726382 stripComments:false  logicalFilePath:base-release/fimaki_back_db/tables/bko_factura.sql runAlways:false runOnChange:false replaceIfExists:true failOnError:true
-- sqlcl_snapshot src/database/fimaki_back_db/tables/bko_factura.sql:null:725fc8b809415db5a7313e1e8398cfc77326daf4:create

create table fimaki_back_db.bko_factura (
    id_factura                  number
        generated by default as identity
    not null enable,
    fecha_ingreso               date not null enable,
    fecha_emision               date,
    tipo_comprobante_rc         varchar2(20 char) not null enable,
    serie                       varchar2(10 char) not null enable,
    numero                      varchar2(10 char) not null enable,
    moneda_rc                   varchar2(20 char) not null enable,
    monto_total                 number not null enable,
    detraccion                  number not null enable,
    descuentos                  number not null enable,
    saldo_a_pago                number not null enable,
    fecha_vencimiento           date not null enable,
    observacion                 varchar2(4000 char),
    id_empresa_cedente          number not null enable,
    id_empresa_pagador          number not null enable,
    estado_factura_rc           varchar2(20 char) not null enable,
    fecha_pago                  date,
    score_operacion_rc          varchar2(20 char) default null not null enable,
    score_cedente_rc            varchar2(20 char) default null,
    score_pagador_rc            varchar2(20 char) default null,
    fecha_publicacion           date,
    visible_en_oportunidades_sn varchar2(1 char),
    financiado_pct              number not null enable,
    por_financiar_pct           number not null enable,
    monto_financiado            number not null enable,
    monto_por_financiar         number not null enable,
    tasa_interes                number not null enable,
    plazo_en_dias               number not null enable,
    roi                         number not null enable,
    factrack_sn                 varchar2(1 char) default 'N' not null enable,
    fecha_carga_factrack        date,
    conformidad_sunat           varchar2(20 char),
    fecha_carga_sunat           date,
    creado_por                  varchar2(100 char) default sys_context('USERENV', 'SESSION_USER') not null enable,
    creado                      timestamp(6) with local time zone default current_timestamp not null enable,
    modificado_por              varchar2(100 char),
    modificado                  timestamp(6) with local time zone,
    anexo1_nombre               varchar2(255 char),
    anexo1_tipo_mime            varchar2(100 char),
    anexo1_contenido            blob,
    anexo2_nombre               varchar2(255 char),
    anexo2_tipo_mime            varchar2(100 char),
    anexo2_contenido            blob
);

alter table fimaki_back_db.bko_factura
    add
        check ( factrack_sn in ( 'S', 'N' ) ) enable;

alter table fimaki_back_db.bko_factura
    add
        check ( visible_en_oportunidades_sn in ( 'S', 'N' ) ) enable;

alter table fimaki_back_db.bko_factura
    add constraint bko_factura_pk primary key ( id_factura )
        using index enable;

alter table fimaki_back_db.bko_factura
    add constraint bko_factura_serie_numero_uk1 unique ( serie,
                                                         numero )
        using index enable;

alter table fimaki_back_db.bko_factura
    add constraint bko_factura_uk1
        unique ( id_empresa_cedente,
                 serie,
                 numero )
            using index enable;

